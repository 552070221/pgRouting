 BEGIN;
BEGIN
SET client_min_messages TO NOTICE;
SET
UPDATE edge_table SET cost = cost + 0.001 * id * id, reverse_cost = reverse_cost + 0.001 * id * id;
UPDATE 18
SELECT * FROM pgr_kruskal(
    'SELECT id, source, target, cost, reverse_cost FROM edge_table ORDER BY id'
);
 seq | depth | node | edge | cost  | agg_cost
-----+-------+------+------+-------+----------
   1 |     0 |    2 |    1 | 1.001 |        0
   2 |     0 |    3 |    2 | 1.004 |        0
   3 |     0 |    4 |    3 | 1.009 |        0
   4 |     0 |    5 |    4 | 1.016 |        0
   5 |     0 |    6 |    5 | 1.025 |        0
   6 |     0 |    8 |    6 | 1.036 |        0
   7 |     0 |    5 |    7 | 1.049 |        0
   8 |     0 |    9 |    9 | 1.081 |        0
   9 |     0 |   10 |   10 |   1.1 |        0
  10 |     0 |   11 |   11 | 1.121 |        0
  11 |     0 |   12 |   13 | 1.169 |        0
  12 |     0 |   13 |   14 | 1.196 |        0
  13 |     0 |   15 |   17 | 1.289 |        0
  14 |     0 |   17 |   18 | 1.324 |        0
(14 rows)

SELECT * FROM pgr_kruskal(
    'SELECT id, source, target, cost, reverse_cost FROM edge_table ORDER BY id',
    order_by := 'dfs'
);
 seq | depth | node | edge | cost  | agg_cost
-----+-------+------+------+-------+----------
   1 |     1 |    2 |   -1 |     0 |        0
   2 |     2 |    1 |    1 | 1.001 |    1.001
   3 |     2 |    3 |    2 | 1.004 |    1.004
   4 |     3 |    4 |    3 | 1.009 |    2.013
   5 |     3 |    6 |    5 | 1.025 |    2.029
   6 |     4 |    9 |    9 | 1.081 |     3.11
   7 |     4 |   11 |   11 | 1.121 |     3.15
   8 |     5 |   12 |   13 | 1.169 |    4.319
   9 |     2 |    5 |    4 | 1.016 |    1.016
  10 |     3 |    8 |    7 | 1.049 |    2.065
  11 |     4 |    7 |    6 | 1.036 |    3.101
  12 |     3 |   10 |   10 |   1.1 |    2.116
  13 |     4 |   13 |   14 | 1.196 |    3.312
  14 |     1 |   15 |   -1 |     0 |        0
  15 |     2 |   14 |   17 | 1.289 |    1.289
  16 |     1 |   17 |   -1 |     0 |        0
  17 |     2 |   16 |   18 | 1.324 |    1.324
(17 rows)

SELECT * FROM pgr_kruskal(
    'SELECT id, source, target, cost, reverse_cost FROM edge_table ORDER BY id',
    'dfs'
);
 seq | depth | node | edge | cost  | agg_cost
-----+-------+------+------+-------+----------
   1 |     1 |    2 |   -1 |     0 |        0
   2 |     2 |    1 |    1 | 1.001 |    1.001
   3 |     2 |    3 |    2 | 1.004 |    1.004
   4 |     3 |    4 |    3 | 1.009 |    2.013
   5 |     3 |    6 |    5 | 1.025 |    2.029
   6 |     4 |    9 |    9 | 1.081 |     3.11
   7 |     4 |   11 |   11 | 1.121 |     3.15
   8 |     5 |   12 |   13 | 1.169 |    4.319
   9 |     2 |    5 |    4 | 1.016 |    1.016
  10 |     3 |    8 |    7 | 1.049 |    2.065
  11 |     4 |    7 |    6 | 1.036 |    3.101
  12 |     3 |   10 |   10 |   1.1 |    2.116
  13 |     4 |   13 |   14 | 1.196 |    3.312
  14 |     1 |   15 |   -1 |     0 |        0
  15 |     2 |   14 |   17 | 1.289 |    1.289
  16 |     1 |   17 |   -1 |     0 |        0
  17 |     2 |   16 |   18 | 1.324 |    1.324
(17 rows)

SELECT * FROM pgr_kruskal(
    'SELECT id, source, target, cost, reverse_cost FROM edge_table ORDER BY id',
    order_by := 'dfs'
);
 seq | depth | node | edge | cost  | agg_cost
-----+-------+------+------+-------+----------
   1 |     1 |    2 |   -1 |     0 |        0
   2 |     2 |    1 |    1 | 1.001 |    1.001
   3 |     2 |    3 |    2 | 1.004 |    1.004
   4 |     3 |    4 |    3 | 1.009 |    2.013
   5 |     3 |    6 |    5 | 1.025 |    2.029
   6 |     4 |    9 |    9 | 1.081 |     3.11
   7 |     4 |   11 |   11 | 1.121 |     3.15
   8 |     5 |   12 |   13 | 1.169 |    4.319
   9 |     2 |    5 |    4 | 1.016 |    1.016
  10 |     3 |    8 |    7 | 1.049 |    2.065
  11 |     4 |    7 |    6 | 1.036 |    3.101
  12 |     3 |   10 |   10 |   1.1 |    2.116
  13 |     4 |   13 |   14 | 1.196 |    3.312
  14 |     1 |   15 |   -1 |     0 |        0
  15 |     2 |   14 |   17 | 1.289 |    1.289
  16 |     1 |   17 |   -1 |     0 |        0
  17 |     2 |   16 |   18 | 1.324 |    1.324
(17 rows)

SELECT * FROM pgr_kruskal(
    'SELECT id, source, target, cost, reverse_cost FROM edge_table ORDER BY id',
    'dfs'
);
 seq | depth | node | edge | cost  | agg_cost
-----+-------+------+------+-------+----------
   1 |     1 |    2 |   -1 |     0 |        0
   2 |     2 |    1 |    1 | 1.001 |    1.001
   3 |     2 |    3 |    2 | 1.004 |    1.004
   4 |     3 |    4 |    3 | 1.009 |    2.013
   5 |     3 |    6 |    5 | 1.025 |    2.029
   6 |     4 |    9 |    9 | 1.081 |     3.11
   7 |     4 |   11 |   11 | 1.121 |     3.15
   8 |     5 |   12 |   13 | 1.169 |    4.319
   9 |     2 |    5 |    4 | 1.016 |    1.016
  10 |     3 |    8 |    7 | 1.049 |    2.065
  11 |     4 |    7 |    6 | 1.036 |    3.101
  12 |     3 |   10 |   10 |   1.1 |    2.116
  13 |     4 |   13 |   14 | 1.196 |    3.312
  14 |     1 |   15 |   -1 |     0 |        0
  15 |     2 |   14 |   17 | 1.289 |    1.289
  16 |     1 |   17 |   -1 |     0 |        0
  17 |     2 |   16 |   18 | 1.324 |    1.324
(17 rows)

SELECT * FROM pgr_kruskal(
    'SELECT id, source, target, cost, reverse_cost FROM edge_table ORDER BY id',
    5,
    order_by := 'dfs'
);
 seq | depth | node | edge | cost  | agg_cost
-----+-------+------+------+-------+----------
   1 |     1 |    5 |   -1 |     0 |        0
   2 |     2 |    2 |    4 | 1.016 |    1.016
   3 |     3 |    1 |    1 | 1.001 |    2.017
   4 |     3 |    3 |    2 | 1.004 |     2.02
   5 |     4 |    4 |    3 | 1.009 |    3.029
   6 |     4 |    6 |    5 | 1.025 |    3.045
   7 |     5 |    9 |    9 | 1.081 |    4.126
   8 |     5 |   11 |   11 | 1.121 |    4.166
   9 |     6 |   12 |   13 | 1.169 |    5.335
  10 |     2 |    8 |    7 | 1.049 |    1.049
  11 |     3 |    7 |    6 | 1.036 |    2.085
  12 |     2 |   10 |   10 |   1.1 |      1.1
  13 |     3 |   13 |   14 | 1.196 |    2.296
(13 rows)

SELECT * FROM pgr_kruskal(
    'SELECT id, source, target, cost, reverse_cost FROM edge_table ORDER BY id',
    5,
    order_by := 'bfs'
);
 seq | depth | node | edge | cost  | agg_cost
-----+-------+------+------+-------+----------
   1 |     1 |    5 |   -1 |     0 |        0
   2 |     2 |    2 |    4 | 1.016 |    1.016
   3 |     2 |    8 |    7 | 1.049 |    1.049
   4 |     2 |   10 |   10 |   1.1 |      1.1
   5 |     3 |    1 |    1 | 1.001 |    2.017
   6 |     3 |    3 |    2 | 1.004 |     2.02
   7 |     3 |    7 |    6 | 1.036 |    2.085
   8 |     3 |   13 |   14 | 1.196 |    2.296
   9 |     4 |    4 |    3 | 1.009 |    3.029
  10 |     4 |    6 |    5 | 1.025 |    3.045
  11 |     5 |    9 |    9 | 1.081 |    4.126
  12 |     5 |   11 |   11 | 1.121 |    4.166
  13 |     6 |   12 |   13 | 1.169 |    5.335
(13 rows)

SELECT * FROM pgr_kruskal(
    'SELECT id, source, target, cost, reverse_cost FROM edge_table ORDER BY id',
    5
);
 seq | depth | node | edge | cost  | agg_cost
-----+-------+------+------+-------+----------
   1 |     1 |    5 |   -1 |     0 |        0
   2 |     2 |    2 |    4 | 1.016 |    1.016
   3 |     3 |    1 |    1 | 1.001 |    2.017
   4 |     3 |    3 |    2 | 1.004 |     2.02
   5 |     4 |    4 |    3 | 1.009 |    3.029
   6 |     4 |    6 |    5 | 1.025 |    3.045
   7 |     5 |    9 |    9 | 1.081 |    4.126
   8 |     5 |   11 |   11 | 1.121 |    4.166
   9 |     6 |   12 |   13 | 1.169 |    5.335
  10 |     2 |    8 |    7 | 1.049 |    1.049
  11 |     3 |    7 |    6 | 1.036 |    2.085
  12 |     2 |   10 |   10 |   1.1 |      1.1
  13 |     3 |   13 |   14 | 1.196 |    2.296
(13 rows)

SELECT * FROM pgr_kruskal(
    'SELECT id, source, target, cost, reverse_cost FROM edge_table ORDER BY id',
    order_by := ''
);
 seq | depth | node | edge | cost  | agg_cost
-----+-------+------+------+-------+----------
   1 |     0 |    2 |    1 | 1.001 |        0
   2 |     0 |    3 |    2 | 1.004 |        0
   3 |     0 |    4 |    3 | 1.009 |        0
   4 |     0 |    5 |    4 | 1.016 |        0
   5 |     0 |    6 |    5 | 1.025 |        0
   6 |     0 |    8 |    6 | 1.036 |        0
   7 |     0 |    5 |    7 | 1.049 |        0
   8 |     0 |    9 |    9 | 1.081 |        0
   9 |     0 |   10 |   10 |   1.1 |        0
  10 |     0 |   11 |   11 | 1.121 |        0
  11 |     0 |   12 |   13 | 1.169 |        0
  12 |     0 |   13 |   14 | 1.196 |        0
  13 |     0 |   15 |   17 | 1.289 |        0
  14 |     0 |   17 |   18 | 1.324 |        0
(14 rows)

ROLLBACK;
ROLLBACK
