BEGIN;
BEGIN
SET client_min_messages TO NOTICE;
SET
UPDATE edge_table SET cost = cost + 0.001 * id * id, reverse_cost = reverse_cost + 0.001 * id * id;
UPDATE 18
SELECT * FROM pgr_kruskal(
    'SELECT id, source, target, cost, reverse_cost FROM edge_table ORDER BY id'
);
 seq | edge | cost
-----+------+-------
   1 |    1 | 1.001
   2 |    2 | 1.004
   3 |    3 | 1.009
   4 |    4 | 1.016
   5 |    5 | 1.025
   6 |    6 | 1.036
   7 |    7 | 1.049
   8 |    9 | 1.081
   9 |   10 |   1.1
  10 |   11 | 1.121
  11 |   13 | 1.169
  12 |   14 | 1.196
  13 |   17 | 1.289
  14 |   18 | 1.324
(14 rows)

SELECT * FROM pgr_kruskalDFS(
    'SELECT id, source, target, cost, reverse_cost FROM edge_table ORDER BY id',
    0
);
 seq | depth | node | edge | cost  | agg_cost
-----+-------+------+------+-------+----------
   1 |     1 |    2 |   -1 |     0 |        0
   2 |     2 |    1 |    1 | 1.001 |    1.001
   3 |     2 |    3 |    2 | 1.004 |    1.004
   4 |     3 |    4 |    3 | 1.009 |    2.013
   5 |     3 |    6 |    5 | 1.025 |    2.029
   6 |     4 |    9 |    9 | 1.081 |     3.11
   7 |     4 |   11 |   11 | 1.121 |     3.15
   8 |     5 |   12 |   13 | 1.169 |    4.319
   9 |     2 |    5 |    4 | 1.016 |    1.016
  10 |     3 |    8 |    7 | 1.049 |    2.065
  11 |     4 |    7 |    6 | 1.036 |    3.101
  12 |     3 |   10 |   10 |   1.1 |    2.116
  13 |     4 |   13 |   14 | 1.196 |    3.312
  14 |     1 |   15 |   -1 |     0 |        0
  15 |     2 |   14 |   17 | 1.289 |    1.289
  16 |     1 |   17 |   -1 |     0 |        0
  17 |     2 |   16 |   18 | 1.324 |    1.324
(17 rows)

SELECT * FROM pgr_kruskalDFS(
    'SELECT id, source, target, cost, reverse_cost FROM edge_table ORDER BY id',
    5
);
 seq | depth | node | edge | cost  | agg_cost
-----+-------+------+------+-------+----------
   1 |     1 |    5 |   -1 |     0 |        0
   2 |     2 |    2 |    4 | 1.016 |    1.016
   3 |     3 |    1 |    1 | 1.001 |    2.017
   4 |     3 |    3 |    2 | 1.004 |     2.02
   5 |     4 |    4 |    3 | 1.009 |    3.029
   6 |     4 |    6 |    5 | 1.025 |    3.045
   7 |     5 |    9 |    9 | 1.081 |    4.126
   8 |     5 |   11 |   11 | 1.121 |    4.166
   9 |     6 |   12 |   13 | 1.169 |    5.335
  10 |     2 |    8 |    7 | 1.049 |    1.049
  11 |     3 |    7 |    6 | 1.036 |    2.085
  12 |     2 |   10 |   10 |   1.1 |      1.1
  13 |     3 |   13 |   14 | 1.196 |    2.296
(13 rows)

SELECT * FROM pgr_kruskalDFS(
    'SELECT id, source, target, cost, reverse_cost FROM edge_table ORDER BY id',
    5,
    max_depth := 3
);
 seq | depth | node | edge | cost  | agg_cost
-----+-------+------+------+-------+----------
   1 |     1 |    5 |   -1 |     0 |        0
   2 |     2 |    2 |    4 | 1.016 |    1.016
   3 |     3 |    1 |    1 | 1.001 |    2.017
   4 |     3 |    3 |    2 | 1.004 |     2.02
   5 |     4 |    4 |    3 | 1.009 |    3.029
   6 |     4 |    6 |    5 | 1.025 |    3.045
   7 |     5 |    9 |    9 | 1.081 |    4.126
   8 |     5 |   11 |   11 | 1.121 |    4.166
   9 |     6 |   12 |   13 | 1.169 |    5.335
  10 |     2 |    8 |    7 | 1.049 |    1.049
  11 |     3 |    7 |    6 | 1.036 |    2.085
  12 |     2 |   10 |   10 |   1.1 |      1.1
  13 |     3 |   13 |   14 | 1.196 |    2.296
(13 rows)

SELECT * FROM pgr_kruskalBFS(
    'SELECT id, source, target, cost, reverse_cost FROM edge_table ORDER BY id',
    0
);
 seq | depth | node | edge | cost  | agg_cost
-----+-------+------+------+-------+----------
   1 |     1 |    1 |   -1 |     0 |        0
   2 |     2 |    2 |    1 | 1.001 |    1.001
   3 |     3 |    3 |    2 | 1.004 |    2.005
   4 |     3 |    5 |    4 | 1.016 |    2.017
   5 |     4 |    4 |    3 | 1.009 |    3.014
   6 |     4 |    6 |    5 | 1.025 |     3.03
   7 |     4 |    8 |    7 | 1.049 |    3.066
   8 |     4 |   10 |   10 |   1.1 |    3.117
   9 |     5 |    9 |    9 | 1.081 |    4.111
  10 |     5 |   11 |   11 | 1.121 |    4.151
  11 |     5 |    7 |    6 | 1.036 |    4.102
  12 |     5 |   13 |   14 | 1.196 |    4.313
  13 |     6 |   12 |   13 | 1.169 |     5.32
  14 |     1 |   14 |   -1 |     0 |        0
  15 |     2 |   15 |   17 | 1.289 |    1.289
  16 |     1 |   16 |   -1 |     0 |        0
  17 |     2 |   17 |   18 | 1.324 |    1.324
(17 rows)

SELECT * FROM pgr_kruskalBFS(
    'SELECT id, source, target, cost, reverse_cost FROM edge_table ORDER BY id',
    5
);
 seq | depth | node | edge | cost  | agg_cost
-----+-------+------+------+-------+----------
   1 |     1 |    5 |   -1 |     0 |        0
   2 |     2 |    2 |    4 | 1.016 |    1.016
   3 |     2 |    8 |    7 | 1.049 |    1.049
   4 |     2 |   10 |   10 |   1.1 |      1.1
   5 |     3 |    1 |    1 | 1.001 |    2.017
   6 |     3 |    3 |    2 | 1.004 |     2.02
   7 |     3 |    7 |    6 | 1.036 |    2.085
   8 |     3 |   13 |   14 | 1.196 |    2.296
   9 |     4 |    4 |    3 | 1.009 |    3.029
  10 |     4 |    6 |    5 | 1.025 |    3.045
  11 |     5 |    9 |    9 | 1.081 |    4.126
  12 |     5 |   11 |   11 | 1.121 |    4.166
  13 |     6 |   12 |   13 | 1.169 |    5.335
(13 rows)

SELECT * FROM pgr_kruskalBFS(
    'SELECT id, source, target, cost, reverse_cost FROM edge_table ORDER BY id',
    5,
    max_depth := 3
);
 seq | depth | node | edge | cost  | agg_cost
-----+-------+------+------+-------+----------
   1 |     1 |    5 |   -1 |     0 |        0
   2 |     2 |    2 |    4 | 1.016 |    1.016
   3 |     2 |    8 |    7 | 1.049 |    1.049
   4 |     2 |   10 |   10 |   1.1 |      1.1
   5 |     3 |    1 |    1 | 1.001 |    2.017
   6 |     3 |    3 |    2 | 1.004 |     2.02
   7 |     3 |    7 |    6 | 1.036 |    2.085
   8 |     3 |   13 |   14 | 1.196 |    2.296
   9 |     4 |    4 |    3 | 1.009 |    3.029
  10 |     4 |    6 |    5 | 1.025 |    3.045
  11 |     5 |    9 |    9 | 1.081 |    4.126
  12 |     5 |   11 |   11 | 1.121 |    4.166
  13 |     6 |   12 |   13 | 1.169 |    5.335
(13 rows)

SELECT * FROM pgr_kruskalDD(
    'SELECT id, source, target, cost, reverse_cost FROM edge_table ORDER BY id',
    5,
    3.5
);
 seq | depth | node | edge | cost  | agg_cost
-----+-------+------+------+-------+----------
   1 |     1 |    5 |   -1 |     0 |        0
   2 |     2 |    2 |    4 | 1.016 |    1.016
   3 |     3 |    1 |    1 | 1.001 |    2.017
   4 |     3 |    3 |    2 | 1.004 |     2.02
   5 |     4 |    4 |    3 | 1.009 |    3.029
   6 |     4 |    6 |    5 | 1.025 |    3.045
   7 |     5 |    9 |    9 | 1.081 |    4.126
   8 |     5 |   11 |   11 | 1.121 |    4.166
   9 |     6 |   12 |   13 | 1.169 |    5.335
  10 |     2 |    8 |    7 | 1.049 |    1.049
  11 |     3 |    7 |    6 | 1.036 |    2.085
  12 |     2 |   10 |   10 |   1.1 |      1.1
  13 |     3 |   13 |   14 | 1.196 |    2.296
(13 rows)

ROLLBACK;
ROLLBACK
