BEGIN;
BEGIN
SET client_min_messages TO NOTICE;
SET
UPDATE edge_table SET id = id * 100, source = 1000 * source, target = 1000 * target;
UPDATE 18
UPDATE edge_table_vertices_pgr SET id = id * 1000;
UPDATE 17
DROP TABLE IF EXISTS result1;
NOTICE:  table "result1" does not exist, skipping
DROP TABLE
SELECT  *, 0 AS edge  INTO result1 FROM pgr_turnPenaltyGraph(
    $$SELECT id, source, target, cost, reverse_cost
    FROM edge_table$$
);
SELECT 95
SELECT * FROM result1;
 seq | source | target | cost | original_source_vertex | original_source_edge | original_target_vertex | original_target_edge | edge 
-----+--------+--------+------+------------------------+----------------------+------------------------+----------------------+------
   1 |      1 |      5 |    1 |                   1000 |                  100 |                   2000 |                  100 |    0
   2 |      2 |      1 |    0 |                   1000 |                 -100 |                   1000 |                  100 |    0
   3 |      3 |      2 |    1 |                   2000 |                 -100 |                   1000 |                 -100 |    0
   4 |      4 |     18 |    1 |                   2000 |                  400 |                   5000 |                  400 |    0
   5 |      5 |      3 |    0 |                   2000 |                  100 |                   2000 |                 -100 |    0
   6 |      5 |      4 |    0 |                   2000 |                  100 |                   2000 |                  400 |    0
   7 |      6 |      3 |    0 |                   2000 |                 -200 |                   2000 |                 -100 |    0
   8 |      6 |      4 |    0 |                   2000 |                 -200 |                   2000 |                  400 |    0
   9 |      7 |      3 |    0 |                   2000 |                 -400 |                   2000 |                 -100 |    0
  10 |      7 |      4 |    0 |                   2000 |                 -400 |                   2000 |                  400 |    0
  11 |      8 |      6 |    1 |                   3000 |                 -200 |                   2000 |                 -200 |    0
  12 |      9 |     25 |    1 |                   3000 |                  500 |                   6000 |                  500 |    0
  13 |     10 |      8 |    0 |                   3000 |                 -300 |                   3000 |                 -200 |    0
  14 |     10 |      9 |    0 |                   3000 |                 -300 |                   3000 |                  500 |    0
  15 |     11 |     10 |    1 |                   4000 |                 -300 |                   3000 |                 -300 |    0
  16 |     12 |     39 |    1 |                   4000 |                 1600 |                   9000 |                 1600 |    0
  17 |     13 |     11 |    0 |                   4000 |                -1600 |                   4000 |                 -300 |    0
  18 |     13 |     12 |    0 |                   4000 |                -1600 |                   4000 |                 1600 |    0
  19 |     14 |      7 |    1 |                   5000 |                 -400 |                   2000 |                 -400 |    0
  20 |     15 |     33 |    1 |                   5000 |                 -700 |                   8000 |                 -700 |    0
  21 |     16 |     26 |    1 |                   5000 |                  800 |                   6000 |                  800 |    0
  22 |     17 |     43 |    1 |                   5000 |                 1000 |                  10000 |                 1000 |    0
  23 |     18 |     14 |    0 |                   5000 |                  400 |                   5000 |                 -400 |    0
  24 |     18 |     15 |    0 |                   5000 |                  400 |                   5000 |                 -700 |    0
  25 |     18 |     16 |    0 |                   5000 |                  400 |                   5000 |                  800 |    0
  26 |     18 |     17 |    0 |                   5000 |                  400 |                   5000 |                 1000 |    0
  27 |     19 |     14 |    0 |                   5000 |                  700 |                   5000 |                 -400 |    0
  28 |     19 |     15 |    0 |                   5000 |                  700 |                   5000 |                 -700 |    0
  29 |     19 |     16 |    0 |                   5000 |                  700 |                   5000 |                  800 |    0
  30 |     19 |     17 |    0 |                   5000 |                  700 |                   5000 |                 1000 |    0
  31 |     20 |     14 |    0 |                   5000 |                 -800 |                   5000 |                 -400 |    0
  32 |     20 |     15 |    0 |                   5000 |                 -800 |                   5000 |                 -700 |    0
  33 |     20 |     16 |    0 |                   5000 |                 -800 |                   5000 |                  800 |    0
  34 |     20 |     17 |    0 |                   5000 |                 -800 |                   5000 |                 1000 |    0
  35 |     21 |     14 |    0 |                   5000 |                -1000 |                   5000 |                 -400 |    0
  36 |     21 |     15 |    0 |                   5000 |                -1000 |                   5000 |                 -700 |    0
  37 |     21 |     16 |    0 |                   5000 |                -1000 |                   5000 |                  800 |    0
  38 |     21 |     17 |    0 |                   5000 |                -1000 |                   5000 |                 1000 |    0
  39 |     22 |     20 |    1 |                   6000 |                 -800 |                   5000 |                 -800 |    0
  40 |     23 |     37 |    1 |                   6000 |                  900 |                   9000 |                  900 |    0
  41 |     24 |     46 |    1 |                   6000 |                 1100 |                  11000 |                 1100 |    0
  42 |     25 |     22 |    0 |                   6000 |                  500 |                   6000 |                 -800 |    0
  43 |     25 |     23 |    0 |                   6000 |                  500 |                   6000 |                  900 |    0
  44 |     25 |     24 |    0 |                   6000 |                  500 |                   6000 |                 1100 |    0
  45 |     26 |     22 |    0 |                   6000 |                  800 |                   6000 |                 -800 |    0
  46 |     26 |     23 |    0 |                   6000 |                  800 |                   6000 |                  900 |    0
  47 |     26 |     24 |    0 |                   6000 |                  800 |                   6000 |                 1100 |    0
  48 |     27 |     22 |    0 |                   6000 |                 -900 |                   6000 |                 -800 |    0
  49 |     27 |     23 |    0 |                   6000 |                 -900 |                   6000 |                  900 |    0
  50 |     27 |     24 |    0 |                   6000 |                 -900 |                   6000 |                 1100 |    0
  51 |     28 |     32 |    1 |                   7000 |                  600 |                   8000 |                  600 |    0
  52 |     29 |     28 |    0 |                   7000 |                 -600 |                   7000 |                  600 |    0
  53 |     30 |     29 |    1 |                   8000 |                 -600 |                   7000 |                 -600 |    0
  54 |     31 |     19 |    1 |                   8000 |                  700 |                   5000 |                  700 |    0
  55 |     32 |     30 |    0 |                   8000 |                  600 |                   8000 |                 -600 |    0
  56 |     32 |     31 |    0 |                   8000 |                  600 |                   8000 |                  700 |    0
  57 |     33 |     30 |    0 |                   8000 |                 -700 |                   8000 |                 -600 |    0
  58 |     33 |     31 |    0 |                   8000 |                 -700 |                   8000 |                  700 |    0
  59 |     34 |     27 |    1 |                   9000 |                 -900 |                   6000 |                 -900 |    0
  60 |     35 |     50 |    1 |                   9000 |                 1500 |                  12000 |                 1500 |    0
  61 |     36 |     13 |    1 |                   9000 |                -1600 |                   4000 |                -1600 |    0
  62 |     37 |     34 |    0 |                   9000 |                  900 |                   9000 |                 -900 |    0
  63 |     37 |     35 |    0 |                   9000 |                  900 |                   9000 |                 1500 |    0
  64 |     37 |     36 |    0 |                   9000 |                  900 |                   9000 |                -1600 |    0
  65 |     38 |     34 |    0 |                   9000 |                -1500 |                   9000 |                 -900 |    0
  66 |     38 |     35 |    0 |                   9000 |                -1500 |                   9000 |                 1500 |    0
  67 |     38 |     36 |    0 |                   9000 |                -1500 |                   9000 |                -1600 |    0
  68 |     39 |     34 |    0 |                   9000 |                 1600 |                   9000 |                 -900 |    0
  69 |     39 |     35 |    0 |                   9000 |                 1600 |                   9000 |                 1500 |    0
  70 |     39 |     36 |    0 |                   9000 |                 1600 |                   9000 |                -1600 |    0
  71 |     40 |     21 |    1 |                  10000 |                -1000 |                   5000 |                -1000 |    0
  72 |     41 |     47 |    1 |                  10000 |                 1200 |                  11000 |                 1200 |    0
  73 |     42 |     52 |    1 |                  10000 |                 1400 |                  13000 |                 1400 |    0
  74 |     43 |     40 |    0 |                  10000 |                 1000 |                  10000 |                -1000 |    0
  75 |     43 |     41 |    0 |                  10000 |                 1000 |                  10000 |                 1200 |    0
  76 |     43 |     42 |    0 |                  10000 |                 1000 |                  10000 |                 1400 |    0
  77 |     44 |     40 |    0 |                  10000 |                -1400 |                  10000 |                -1000 |    0
  78 |     44 |     41 |    0 |                  10000 |                -1400 |                  10000 |                 1200 |    0
  79 |     44 |     42 |    0 |                  10000 |                -1400 |                  10000 |                 1400 |    0
  80 |     45 |     49 |    1 |                  11000 |                 1300 |                  12000 |                 1300 |    0
  81 |     46 |     45 |    0 |                  11000 |                 1100 |                  11000 |                 1300 |    0
  82 |     47 |     45 |    0 |                  11000 |                 1200 |                  11000 |                 1300 |    0
  83 |     48 |     38 |    1 |                  12000 |                -1500 |                   9000 |                -1500 |    0
  84 |     49 |     48 |    0 |                  12000 |                 1300 |                  12000 |                -1500 |    0
  85 |     50 |     48 |    0 |                  12000 |                 1500 |                  12000 |                -1500 |    0
  86 |     51 |     44 |    1 |                  13000 |                -1400 |                  10000 |                -1400 |    0
  87 |     52 |     51 |    0 |                  13000 |                 1400 |                  13000 |                -1400 |    0
  88 |     53 |     56 |    1 |                  14000 |                 1700 |                  15000 |                 1700 |    0
  89 |     54 |     53 |    0 |                  14000 |                -1700 |                  14000 |                 1700 |    0
  90 |     55 |     54 |    1 |                  15000 |                -1700 |                  14000 |                -1700 |    0
  91 |     56 |     55 |    0 |                  15000 |                 1700 |                  15000 |                -1700 |    0
  92 |     57 |     60 |    1 |                  16000 |                 1800 |                  17000 |                 1800 |    0
  93 |     58 |     57 |    0 |                  16000 |                -1800 |                  16000 |                 1800 |    0
  94 |     59 |     58 |    1 |                  17000 |                -1800 |                  16000 |                -1800 |    0
  95 |     60 |     59 |    0 |                  17000 |                 1800 |                  17000 |                -1800 |    0
(95 rows)

DROP TABLE IF EXISTS temp1;
NOTICE:  table "temp1" does not exist, skipping
DROP TABLE
WITH
rel AS (
    SELECT source, original_source_vertex  FROM result1
    UNION   
    SELECT target, original_target_vertex  FROM result1
),          
unique_rel AS (
    SELECT original_source_vertex, min(source) AS source 
    FROM rel            
    GROUP BY original_source_vertex
),
new_numbers AS (
    SELECT r.seq, u.original_source_vertex AS source, r.target, r.cost, r.edge FROM unique_rel AS u, result1 AS r WHERE u.source = r.source
    UNION               
    SELECT r.seq, r.source, u.original_source_vertex AS target, r.cost, r.edge FROM unique_rel AS u, result1 AS r WHERE u.source = r.target
),
r2 AS (
    SELECT * FROM new_numbers
    UNION
    SELECT r.seq, r.source, r.target, r.cost, r.edge FROM result1 AS r WHERE r.seq NOT IN (SELECT new_numbers.seq AS id FROM new_numbers)
)
SELECT r2.seq, r2.source, r2.target, r2.cost,
    CASE WHEN original_source_edge = original_target_edge THEN original_source_edge
    ELSE r2.edge END AS edge,
    r1.original_source_vertex, r1.original_source_edge,
    r1.original_target_vertex, r1.original_target_edge
INTO temp1
FROM r2 JOIN result1 r1 USING(seq) ORDER by seq;
SELECT 95
SELECT * FROM temp1;
 seq | source | target | cost | edge  | original_source_vertex | original_source_edge | original_target_vertex | original_target_edge 
-----+--------+--------+------+-------+------------------------+----------------------+------------------------+----------------------
   1 |   1000 |      5 |    1 |   100 |                   1000 |                  100 |                   2000 |                  100
   2 |      2 |   1000 |    0 |     0 |                   1000 |                 -100 |                   1000 |                  100
   3 |   2000 |      2 |    1 |  -100 |                   2000 |                 -100 |                   1000 |                 -100
   4 |      4 |     18 |    1 |   400 |                   2000 |                  400 |                   5000 |                  400
   5 |      5 |   2000 |    0 |     0 |                   2000 |                  100 |                   2000 |                 -100
   6 |      5 |      4 |    0 |     0 |                   2000 |                  100 |                   2000 |                  400
   7 |      6 |   2000 |    0 |     0 |                   2000 |                 -200 |                   2000 |                 -100
   8 |      6 |      4 |    0 |     0 |                   2000 |                 -200 |                   2000 |                  400
   9 |      7 |   2000 |    0 |     0 |                   2000 |                 -400 |                   2000 |                 -100
  10 |      7 |      4 |    0 |     0 |                   2000 |                 -400 |                   2000 |                  400
  11 |   3000 |      6 |    1 |  -200 |                   3000 |                 -200 |                   2000 |                 -200
  12 |      9 |     25 |    1 |   500 |                   3000 |                  500 |                   6000 |                  500
  13 |     10 |   3000 |    0 |     0 |                   3000 |                 -300 |                   3000 |                 -200
  14 |     10 |      9 |    0 |     0 |                   3000 |                 -300 |                   3000 |                  500
  15 |   4000 |     10 |    1 |  -300 |                   4000 |                 -300 |                   3000 |                 -300
  16 |     12 |     39 |    1 |  1600 |                   4000 |                 1600 |                   9000 |                 1600
  17 |     13 |   4000 |    0 |     0 |                   4000 |                -1600 |                   4000 |                 -300
  18 |     13 |     12 |    0 |     0 |                   4000 |                -1600 |                   4000 |                 1600
  19 |   5000 |      7 |    1 |  -400 |                   5000 |                 -400 |                   2000 |                 -400
  20 |     15 |     33 |    1 |  -700 |                   5000 |                 -700 |                   8000 |                 -700
  21 |     16 |     26 |    1 |   800 |                   5000 |                  800 |                   6000 |                  800
  22 |     17 |     43 |    1 |  1000 |                   5000 |                 1000 |                  10000 |                 1000
  23 |     18 |   5000 |    0 |     0 |                   5000 |                  400 |                   5000 |                 -400
  24 |     18 |     15 |    0 |     0 |                   5000 |                  400 |                   5000 |                 -700
  25 |     18 |     16 |    0 |     0 |                   5000 |                  400 |                   5000 |                  800
  26 |     18 |     17 |    0 |     0 |                   5000 |                  400 |                   5000 |                 1000
  27 |     19 |   5000 |    0 |     0 |                   5000 |                  700 |                   5000 |                 -400
  28 |     19 |     15 |    0 |     0 |                   5000 |                  700 |                   5000 |                 -700
  29 |     19 |     16 |    0 |     0 |                   5000 |                  700 |                   5000 |                  800
  30 |     19 |     17 |    0 |     0 |                   5000 |                  700 |                   5000 |                 1000
  31 |     20 |   5000 |    0 |     0 |                   5000 |                 -800 |                   5000 |                 -400
  32 |     20 |     15 |    0 |     0 |                   5000 |                 -800 |                   5000 |                 -700
  33 |     20 |     16 |    0 |     0 |                   5000 |                 -800 |                   5000 |                  800
  34 |     20 |     17 |    0 |     0 |                   5000 |                 -800 |                   5000 |                 1000
  35 |     21 |   5000 |    0 |     0 |                   5000 |                -1000 |                   5000 |                 -400
  36 |     21 |     15 |    0 |     0 |                   5000 |                -1000 |                   5000 |                 -700
  37 |     21 |     16 |    0 |     0 |                   5000 |                -1000 |                   5000 |                  800
  38 |     21 |     17 |    0 |     0 |                   5000 |                -1000 |                   5000 |                 1000
  39 |   6000 |     20 |    1 |  -800 |                   6000 |                 -800 |                   5000 |                 -800
  40 |     23 |     37 |    1 |   900 |                   6000 |                  900 |                   9000 |                  900
  41 |     24 |     46 |    1 |  1100 |                   6000 |                 1100 |                  11000 |                 1100
  42 |     25 |   6000 |    0 |     0 |                   6000 |                  500 |                   6000 |                 -800
  43 |     25 |     23 |    0 |     0 |                   6000 |                  500 |                   6000 |                  900
  44 |     25 |     24 |    0 |     0 |                   6000 |                  500 |                   6000 |                 1100
  45 |     26 |   6000 |    0 |     0 |                   6000 |                  800 |                   6000 |                 -800
  46 |     26 |     23 |    0 |     0 |                   6000 |                  800 |                   6000 |                  900
  47 |     26 |     24 |    0 |     0 |                   6000 |                  800 |                   6000 |                 1100
  48 |     27 |   6000 |    0 |     0 |                   6000 |                 -900 |                   6000 |                 -800
  49 |     27 |     23 |    0 |     0 |                   6000 |                 -900 |                   6000 |                  900
  50 |     27 |     24 |    0 |     0 |                   6000 |                 -900 |                   6000 |                 1100
  51 |   7000 |     32 |    1 |   600 |                   7000 |                  600 |                   8000 |                  600
  52 |     29 |   7000 |    0 |     0 |                   7000 |                 -600 |                   7000 |                  600
  53 |   8000 |     29 |    1 |  -600 |                   8000 |                 -600 |                   7000 |                 -600
  54 |     31 |     19 |    1 |   700 |                   8000 |                  700 |                   5000 |                  700
  55 |     32 |   8000 |    0 |     0 |                   8000 |                  600 |                   8000 |                 -600
  56 |     32 |     31 |    0 |     0 |                   8000 |                  600 |                   8000 |                  700
  57 |     33 |   8000 |    0 |     0 |                   8000 |                 -700 |                   8000 |                 -600
  58 |     33 |     31 |    0 |     0 |                   8000 |                 -700 |                   8000 |                  700
  59 |   9000 |     27 |    1 |  -900 |                   9000 |                 -900 |                   6000 |                 -900
  60 |     35 |     50 |    1 |  1500 |                   9000 |                 1500 |                  12000 |                 1500
  61 |     36 |     13 |    1 | -1600 |                   9000 |                -1600 |                   4000 |                -1600
  62 |     37 |   9000 |    0 |     0 |                   9000 |                  900 |                   9000 |                 -900
  63 |     37 |     35 |    0 |     0 |                   9000 |                  900 |                   9000 |                 1500
  64 |     37 |     36 |    0 |     0 |                   9000 |                  900 |                   9000 |                -1600
  65 |     38 |   9000 |    0 |     0 |                   9000 |                -1500 |                   9000 |                 -900
  66 |     38 |     35 |    0 |     0 |                   9000 |                -1500 |                   9000 |                 1500
  67 |     38 |     36 |    0 |     0 |                   9000 |                -1500 |                   9000 |                -1600
  68 |     39 |   9000 |    0 |     0 |                   9000 |                 1600 |                   9000 |                 -900
  69 |     39 |     35 |    0 |     0 |                   9000 |                 1600 |                   9000 |                 1500
  70 |     39 |     36 |    0 |     0 |                   9000 |                 1600 |                   9000 |                -1600
  71 |  10000 |     21 |    1 | -1000 |                  10000 |                -1000 |                   5000 |                -1000
  72 |     41 |     47 |    1 |  1200 |                  10000 |                 1200 |                  11000 |                 1200
  73 |     42 |     52 |    1 |  1400 |                  10000 |                 1400 |                  13000 |                 1400
  74 |     43 |  10000 |    0 |     0 |                  10000 |                 1000 |                  10000 |                -1000
  75 |     43 |     41 |    0 |     0 |                  10000 |                 1000 |                  10000 |                 1200
  76 |     43 |     42 |    0 |     0 |                  10000 |                 1000 |                  10000 |                 1400
  77 |     44 |  10000 |    0 |     0 |                  10000 |                -1400 |                  10000 |                -1000
  78 |     44 |     41 |    0 |     0 |                  10000 |                -1400 |                  10000 |                 1200
  79 |     44 |     42 |    0 |     0 |                  10000 |                -1400 |                  10000 |                 1400
  80 |  11000 |     49 |    1 |  1300 |                  11000 |                 1300 |                  12000 |                 1300
  81 |     46 |  11000 |    0 |     0 |                  11000 |                 1100 |                  11000 |                 1300
  82 |     47 |  11000 |    0 |     0 |                  11000 |                 1200 |                  11000 |                 1300
  83 |  12000 |     38 |    1 | -1500 |                  12000 |                -1500 |                   9000 |                -1500
  84 |     49 |  12000 |    0 |     0 |                  12000 |                 1300 |                  12000 |                -1500
  85 |     50 |  12000 |    0 |     0 |                  12000 |                 1500 |                  12000 |                -1500
  86 |  13000 |     44 |    1 | -1400 |                  13000 |                -1400 |                  10000 |                -1400
  87 |     52 |  13000 |    0 |     0 |                  13000 |                 1400 |                  13000 |                -1400
  88 |  14000 |     56 |    1 |  1700 |                  14000 |                 1700 |                  15000 |                 1700
  89 |     54 |  14000 |    0 |     0 |                  14000 |                -1700 |                  14000 |                 1700
  90 |  15000 |     54 |    1 | -1700 |                  15000 |                -1700 |                  14000 |                -1700
  91 |     56 |  15000 |    0 |     0 |                  15000 |                 1700 |                  15000 |                -1700
  92 |  16000 |     60 |    1 |  1800 |                  16000 |                 1800 |                  17000 |                 1800
  93 |     58 |  16000 |    0 |     0 |                  16000 |                -1800 |                  16000 |                 1800
  94 |  17000 |     58 |    1 | -1800 |                  17000 |                -1800 |                  16000 |                -1800
  95 |     60 |  17000 |    0 |     0 |                  17000 |                 1800 |                  17000 |                -1800
(95 rows)

DROP TABLE IF EXISTS v_table;
NOTICE:  table "v_table" does not exist, skipping
DROP TABLE
WITH a AS (
    SELECT source AS id, original_source_vertex AS original_id FROM temp1
    UNION
    SELECT target, original_target_vertex FROM temp1)
SELECT *
INTO v_table
FROM a
ORDER BY id;
SELECT 60
DROP TABLE IF EXISTS result2;
NOTICE:  table "result2" does not exist, skipping
DROP TABLE
SELECT seq, source, target, cost, edge INTO result2 FROM temp1;
SELECT 95
DROP TABLE IF EXISTS result2_vertices_pgr;
NOTICE:  table "result2_vertices_pgr" does not exist, skipping
DROP TABLE
WITH foo AS (SELECT source AS id FROM result2
    UNION
    SELECT target FROM result2) 
SELECT *, NULL::BIGINT AS original_id
INTO result2_vertices_pgr
FROM foo
ORDER BY id;
SELECT 60
SELECT * from v_table JOIN result2_vertices_pgr USING (id);
  id   | original_id | original_id 
-------+-------------+-------------
     2 |        1000 |            
     4 |        2000 |            
     5 |        2000 |            
     6 |        2000 |            
     7 |        2000 |            
     9 |        3000 |            
    10 |        3000 |            
    12 |        4000 |            
    13 |        4000 |            
    15 |        5000 |            
    16 |        5000 |            
    17 |        5000 |            
    18 |        5000 |            
    19 |        5000 |            
    20 |        5000 |            
    21 |        5000 |            
    23 |        6000 |            
    24 |        6000 |            
    25 |        6000 |            
    26 |        6000 |            
    27 |        6000 |            
    29 |        7000 |            
    31 |        8000 |            
    32 |        8000 |            
    33 |        8000 |            
    35 |        9000 |            
    36 |        9000 |            
    37 |        9000 |            
    38 |        9000 |            
    39 |        9000 |            
    41 |       10000 |            
    42 |       10000 |            
    43 |       10000 |            
    44 |       10000 |            
    46 |       11000 |            
    47 |       11000 |            
    49 |       12000 |            
    50 |       12000 |            
    52 |       13000 |            
    54 |       14000 |            
    56 |       15000 |            
    58 |       16000 |            
    60 |       17000 |            
  1000 |        1000 |            
  2000 |        2000 |            
  3000 |        3000 |            
  4000 |        4000 |            
  5000 |        5000 |            
  6000 |        6000 |            
  7000 |        7000 |            
  8000 |        8000 |            
  9000 |        9000 |            
 10000 |       10000 |            
 11000 |       11000 |            
 12000 |       12000 |            
 13000 |       13000 |            
 14000 |       14000 |            
 15000 |       15000 |            
 16000 |       16000 |            
 17000 |       17000 |            
(60 rows)

UPDATE result2_vertices_pgr AS r SET original_id = v.id
FROM edge_table_vertices_pgr AS v WHERE v.id = r.id;
UPDATE 17
WITH a AS (SELECT e.id, e.original_id FROM result2_vertices_pgr AS e WHERE original_id IS NOT NULL),
b AS (SELECT * FROM result2 WHERE cost = 0 and target IN (SELECT id FROM a)),
c AS (SELECT * FROM b JOIN result2_vertices_pgr ON(target = id)),
d AS (SELECT c.target, v.original_id FROM c JOIN result2_vertices_pgr as v ON (source=v.id)),
e AS (SELECT DISTINCT c.source, c.original_id FROM c JOIN result2_vertices_pgr AS r ON(source = r.id AND r.original_id IS NULL))
UPDATE result2_vertices_pgr SET original_id = e.original_id FROM e WHERE e.source = id;
UPDATE 30
WITH a AS (SELECT e.id, e.original_id FROM result2_vertices_pgr AS e WHERE original_id IS NOT NULL),
b AS (SELECT * FROM result2 WHERE cost = 0 and source IN (SELECT id FROM a)),
c AS (SELECT * FROM b JOIN result2_vertices_pgr ON(source = id)),
d AS (SELECT c.source, v.original_id FROM c JOIN result2_vertices_pgr as v ON (target=v.id)),
e AS (SELECT DISTINCT c.target, c.original_id FROM c JOIN result2_vertices_pgr AS r ON(target = r.id AND r.original_id IS NULL))
UPDATE result2_vertices_pgr SET original_id = e.original_id FROM e WHERE e.target = id;
UPDATE 13
SELECT * from pgr_dijkstra($$SELECT id, * FROM edge_table$$,
    2000, 3000);
 seq | path_seq | node | edge | cost | agg_cost 
-----+----------+------+------+------+----------
   1 |        1 | 2000 |  400 |    1 |        0
   2 |        2 | 5000 |  800 |    1 |        1
   3 |        3 | 6000 |  900 |    1 |        2
   4 |        4 | 9000 | 1600 |    1 |        3
   5 |        5 | 4000 |  300 |    1 |        4
   6 |        6 | 3000 |   -1 |    0 |        5
(6 rows)

DROP TABLE IF EXISTS q_result_1;
NOTICE:  table "q_result_1" does not exist, skipping
DROP TABLE
SELECT * INTO q_result_1
FROM pgr_dijkstra($$SELECT seq AS id, * FROM result2$$,
    (SELECT array_agg(id) FROM result2_vertices_pgr where original_id = 2000),
    (SELECT array_agg(id) FROM result2_vertices_pgr where original_id = 3000)
);
SELECT 181
SELECT * FROM q_result_1;
 seq | path_seq | start_vid | end_vid | node | edge | cost | agg_cost 
-----+----------+-----------+---------+------+------+------+----------
   1 |        1 |         4 |       9 |    4 |    4 |    1 |        0
   2 |        2 |         4 |       9 |   18 |   25 |    0 |        1
   3 |        3 |         4 |       9 |   16 |   21 |    1 |        1
   4 |        4 |         4 |       9 |   26 |   46 |    0 |        2
   5 |        5 |         4 |       9 |   23 |   40 |    1 |        2
   6 |        6 |         4 |       9 |   37 |   64 |    0 |        3
   7 |        7 |         4 |       9 |   36 |   61 |    1 |        3
   8 |        8 |         4 |       9 |   13 |   17 |    0 |        4
   9 |        9 |         4 |       9 | 4000 |   15 |    1 |        4
  10 |       10 |         4 |       9 |   10 |   14 |    0 |        5
  11 |       11 |         4 |       9 |    9 |   -1 |    0 |        5
  12 |        1 |         4 |      10 |    4 |    4 |    1 |        0
  13 |        2 |         4 |      10 |   18 |   25 |    0 |        1
  14 |        3 |         4 |      10 |   16 |   21 |    1 |        1
  15 |        4 |         4 |      10 |   26 |   46 |    0 |        2
  16 |        5 |         4 |      10 |   23 |   40 |    1 |        2
  17 |        6 |         4 |      10 |   37 |   64 |    0 |        3
  18 |        7 |         4 |      10 |   36 |   61 |    1 |        3
  19 |        8 |         4 |      10 |   13 |   17 |    0 |        4
  20 |        9 |         4 |      10 | 4000 |   15 |    1 |        4
  21 |       10 |         4 |      10 |   10 |   -1 |    0 |        5
  22 |        1 |         4 |    3000 |    4 |    4 |    1 |        0
  23 |        2 |         4 |    3000 |   18 |   25 |    0 |        1
  24 |        3 |         4 |    3000 |   16 |   21 |    1 |        1
  25 |        4 |         4 |    3000 |   26 |   46 |    0 |        2
  26 |        5 |         4 |    3000 |   23 |   40 |    1 |        2
  27 |        6 |         4 |    3000 |   37 |   64 |    0 |        3
  28 |        7 |         4 |    3000 |   36 |   61 |    1 |        3
  29 |        8 |         4 |    3000 |   13 |   17 |    0 |        4
  30 |        9 |         4 |    3000 | 4000 |   15 |    1 |        4
  31 |       10 |         4 |    3000 |   10 |   13 |    0 |        5
  32 |       11 |         4 |    3000 | 3000 |   -1 |    0 |        5
  33 |        1 |         5 |       9 |    5 |    6 |    0 |        0
  34 |        2 |         5 |       9 |    4 |    4 |    1 |        0
  35 |        3 |         5 |       9 |   18 |   25 |    0 |        1
  36 |        4 |         5 |       9 |   16 |   21 |    1 |        1
  37 |        5 |         5 |       9 |   26 |   46 |    0 |        2
  38 |        6 |         5 |       9 |   23 |   40 |    1 |        2
  39 |        7 |         5 |       9 |   37 |   64 |    0 |        3
  40 |        8 |         5 |       9 |   36 |   61 |    1 |        3
  41 |        9 |         5 |       9 |   13 |   17 |    0 |        4
  42 |       10 |         5 |       9 | 4000 |   15 |    1 |        4
  43 |       11 |         5 |       9 |   10 |   14 |    0 |        5
  44 |       12 |         5 |       9 |    9 |   -1 |    0 |        5
  45 |        1 |         5 |      10 |    5 |    6 |    0 |        0
  46 |        2 |         5 |      10 |    4 |    4 |    1 |        0
  47 |        3 |         5 |      10 |   18 |   25 |    0 |        1
  48 |        4 |         5 |      10 |   16 |   21 |    1 |        1
  49 |        5 |         5 |      10 |   26 |   46 |    0 |        2
  50 |        6 |         5 |      10 |   23 |   40 |    1 |        2
  51 |        7 |         5 |      10 |   37 |   64 |    0 |        3
  52 |        8 |         5 |      10 |   36 |   61 |    1 |        3
  53 |        9 |         5 |      10 |   13 |   17 |    0 |        4
  54 |       10 |         5 |      10 | 4000 |   15 |    1 |        4
  55 |       11 |         5 |      10 |   10 |   -1 |    0 |        5
  56 |        1 |         5 |    3000 |    5 |    6 |    0 |        0
  57 |        2 |         5 |    3000 |    4 |    4 |    1 |        0
  58 |        3 |         5 |    3000 |   18 |   25 |    0 |        1
  59 |        4 |         5 |    3000 |   16 |   21 |    1 |        1
  60 |        5 |         5 |    3000 |   26 |   46 |    0 |        2
  61 |        6 |         5 |    3000 |   23 |   40 |    1 |        2
  62 |        7 |         5 |    3000 |   37 |   64 |    0 |        3
  63 |        8 |         5 |    3000 |   36 |   61 |    1 |        3
  64 |        9 |         5 |    3000 |   13 |   17 |    0 |        4
  65 |       10 |         5 |    3000 | 4000 |   15 |    1 |        4
  66 |       11 |         5 |    3000 |   10 |   13 |    0 |        5
  67 |       12 |         5 |    3000 | 3000 |   -1 |    0 |        5
  68 |        1 |         6 |       9 |    6 |    8 |    0 |        0
  69 |        2 |         6 |       9 |    4 |    4 |    1 |        0
  70 |        3 |         6 |       9 |   18 |   25 |    0 |        1
  71 |        4 |         6 |       9 |   16 |   21 |    1 |        1
  72 |        5 |         6 |       9 |   26 |   46 |    0 |        2
  73 |        6 |         6 |       9 |   23 |   40 |    1 |        2
  74 |        7 |         6 |       9 |   37 |   64 |    0 |        3
  75 |        8 |         6 |       9 |   36 |   61 |    1 |        3
  76 |        9 |         6 |       9 |   13 |   17 |    0 |        4
  77 |       10 |         6 |       9 | 4000 |   15 |    1 |        4
  78 |       11 |         6 |       9 |   10 |   14 |    0 |        5
  79 |       12 |         6 |       9 |    9 |   -1 |    0 |        5
  80 |        1 |         6 |      10 |    6 |    8 |    0 |        0
  81 |        2 |         6 |      10 |    4 |    4 |    1 |        0
  82 |        3 |         6 |      10 |   18 |   25 |    0 |        1
  83 |        4 |         6 |      10 |   16 |   21 |    1 |        1
  84 |        5 |         6 |      10 |   26 |   46 |    0 |        2
  85 |        6 |         6 |      10 |   23 |   40 |    1 |        2
  86 |        7 |         6 |      10 |   37 |   64 |    0 |        3
  87 |        8 |         6 |      10 |   36 |   61 |    1 |        3
  88 |        9 |         6 |      10 |   13 |   17 |    0 |        4
  89 |       10 |         6 |      10 | 4000 |   15 |    1 |        4
  90 |       11 |         6 |      10 |   10 |   -1 |    0 |        5
  91 |        1 |         6 |    3000 |    6 |    8 |    0 |        0
  92 |        2 |         6 |    3000 |    4 |    4 |    1 |        0
  93 |        3 |         6 |    3000 |   18 |   25 |    0 |        1
  94 |        4 |         6 |    3000 |   16 |   21 |    1 |        1
  95 |        5 |         6 |    3000 |   26 |   46 |    0 |        2
  96 |        6 |         6 |    3000 |   23 |   40 |    1 |        2
  97 |        7 |         6 |    3000 |   37 |   64 |    0 |        3
  98 |        8 |         6 |    3000 |   36 |   61 |    1 |        3
  99 |        9 |         6 |    3000 |   13 |   17 |    0 |        4
 100 |       10 |         6 |    3000 | 4000 |   15 |    1 |        4
 101 |       11 |         6 |    3000 |   10 |   13 |    0 |        5
 102 |       12 |         6 |    3000 | 3000 |   -1 |    0 |        5
 103 |        1 |         7 |       9 |    7 |   10 |    0 |        0
 104 |        2 |         7 |       9 |    4 |    4 |    1 |        0
 105 |        3 |         7 |       9 |   18 |   25 |    0 |        1
 106 |        4 |         7 |       9 |   16 |   21 |    1 |        1
 107 |        5 |         7 |       9 |   26 |   46 |    0 |        2
 108 |        6 |         7 |       9 |   23 |   40 |    1 |        2
 109 |        7 |         7 |       9 |   37 |   64 |    0 |        3
 110 |        8 |         7 |       9 |   36 |   61 |    1 |        3
 111 |        9 |         7 |       9 |   13 |   17 |    0 |        4
 112 |       10 |         7 |       9 | 4000 |   15 |    1 |        4
 113 |       11 |         7 |       9 |   10 |   14 |    0 |        5
 114 |       12 |         7 |       9 |    9 |   -1 |    0 |        5
 115 |        1 |         7 |      10 |    7 |   10 |    0 |        0
 116 |        2 |         7 |      10 |    4 |    4 |    1 |        0
 117 |        3 |         7 |      10 |   18 |   25 |    0 |        1
 118 |        4 |         7 |      10 |   16 |   21 |    1 |        1
 119 |        5 |         7 |      10 |   26 |   46 |    0 |        2
 120 |        6 |         7 |      10 |   23 |   40 |    1 |        2
 121 |        7 |         7 |      10 |   37 |   64 |    0 |        3
 122 |        8 |         7 |      10 |   36 |   61 |    1 |        3
 123 |        9 |         7 |      10 |   13 |   17 |    0 |        4
 124 |       10 |         7 |      10 | 4000 |   15 |    1 |        4
 125 |       11 |         7 |      10 |   10 |   -1 |    0 |        5
 126 |        1 |         7 |    3000 |    7 |   10 |    0 |        0
 127 |        2 |         7 |    3000 |    4 |    4 |    1 |        0
 128 |        3 |         7 |    3000 |   18 |   25 |    0 |        1
 129 |        4 |         7 |    3000 |   16 |   21 |    1 |        1
 130 |        5 |         7 |    3000 |   26 |   46 |    0 |        2
 131 |        6 |         7 |    3000 |   23 |   40 |    1 |        2
 132 |        7 |         7 |    3000 |   37 |   64 |    0 |        3
 133 |        8 |         7 |    3000 |   36 |   61 |    1 |        3
 134 |        9 |         7 |    3000 |   13 |   17 |    0 |        4
 135 |       10 |         7 |    3000 | 4000 |   15 |    1 |        4
 136 |       11 |         7 |    3000 |   10 |   13 |    0 |        5
 137 |       12 |         7 |    3000 | 3000 |   -1 |    0 |        5
 138 |        1 |      2000 |       9 | 2000 |    3 |    1 |        0
 139 |        2 |      2000 |       9 |    2 |    2 |    0 |        1
 140 |        3 |      2000 |       9 | 1000 |    1 |    1 |        1
 141 |        4 |      2000 |       9 |    5 |    6 |    0 |        2
 142 |        5 |      2000 |       9 |    4 |    4 |    1 |        2
 143 |        6 |      2000 |       9 |   18 |   25 |    0 |        3
 144 |        7 |      2000 |       9 |   16 |   21 |    1 |        3
 145 |        8 |      2000 |       9 |   26 |   46 |    0 |        4
 146 |        9 |      2000 |       9 |   23 |   40 |    1 |        4
 147 |       10 |      2000 |       9 |   37 |   64 |    0 |        5
 148 |       11 |      2000 |       9 |   36 |   61 |    1 |        5
 149 |       12 |      2000 |       9 |   13 |   17 |    0 |        6
 150 |       13 |      2000 |       9 | 4000 |   15 |    1 |        6
 151 |       14 |      2000 |       9 |   10 |   14 |    0 |        7
 152 |       15 |      2000 |       9 |    9 |   -1 |    0 |        7
 153 |        1 |      2000 |      10 | 2000 |    3 |    1 |        0
 154 |        2 |      2000 |      10 |    2 |    2 |    0 |        1
 155 |        3 |      2000 |      10 | 1000 |    1 |    1 |        1
 156 |        4 |      2000 |      10 |    5 |    6 |    0 |        2
 157 |        5 |      2000 |      10 |    4 |    4 |    1 |        2
 158 |        6 |      2000 |      10 |   18 |   25 |    0 |        3
 159 |        7 |      2000 |      10 |   16 |   21 |    1 |        3
 160 |        8 |      2000 |      10 |   26 |   46 |    0 |        4
 161 |        9 |      2000 |      10 |   23 |   40 |    1 |        4
 162 |       10 |      2000 |      10 |   37 |   64 |    0 |        5
 163 |       11 |      2000 |      10 |   36 |   61 |    1 |        5
 164 |       12 |      2000 |      10 |   13 |   17 |    0 |        6
 165 |       13 |      2000 |      10 | 4000 |   15 |    1 |        6
 166 |       14 |      2000 |      10 |   10 |   -1 |    0 |        7
 167 |        1 |      2000 |    3000 | 2000 |    3 |    1 |        0
 168 |        2 |      2000 |    3000 |    2 |    2 |    0 |        1
 169 |        3 |      2000 |    3000 | 1000 |    1 |    1 |        1
 170 |        4 |      2000 |    3000 |    5 |    6 |    0 |        2
 171 |        5 |      2000 |    3000 |    4 |    4 |    1 |        2
 172 |        6 |      2000 |    3000 |   18 |   25 |    0 |        3
 173 |        7 |      2000 |    3000 |   16 |   21 |    1 |        3
 174 |        8 |      2000 |    3000 |   26 |   46 |    0 |        4
 175 |        9 |      2000 |    3000 |   23 |   40 |    1 |        4
 176 |       10 |      2000 |    3000 |   37 |   64 |    0 |        5
 177 |       11 |      2000 |    3000 |   36 |   61 |    1 |        5
 178 |       12 |      2000 |    3000 |   13 |   17 |    0 |        6
 179 |       13 |      2000 |    3000 | 4000 |   15 |    1 |        6
 180 |       14 |      2000 |    3000 |   10 |   13 |    0 |        7
 181 |       15 |      2000 |    3000 | 3000 |   -1 |    0 |        7
(181 rows)

SELECT min(agg_cost) FROM q_result_1 WHERE edge = -1;
 min 
-----
   5
(1 row)

SELECT path_seq, start_vid, end_vid FROM q_result_1 WHERE edge = -1 and agg_cost = 5;
 path_seq | start_vid | end_vid 
----------+-----------+---------
       11 |         4 |       9
       10 |         4 |      10
       11 |         4 |    3000
       12 |         5 |       9
       11 |         5 |      10
       12 |         5 |    3000
       12 |         6 |       9
       11 |         6 |      10
       12 |         6 |    3000
       12 |         7 |       9
       11 |         7 |      10
       12 |         7 |    3000
(12 rows)

SELECT * FROM q_result_1 WHERE start_vid = 4 AND end_vid = 10;
 seq | path_seq | start_vid | end_vid | node | edge | cost | agg_cost 
-----+----------+-----------+---------+------+------+------+----------
  12 |        1 |         4 |      10 |    4 |    4 |    1 |        0
  13 |        2 |         4 |      10 |   18 |   25 |    0 |        1
  14 |        3 |         4 |      10 |   16 |   21 |    1 |        1
  15 |        4 |         4 |      10 |   26 |   46 |    0 |        2
  16 |        5 |         4 |      10 |   23 |   40 |    1 |        2
  17 |        6 |         4 |      10 |   37 |   64 |    0 |        3
  18 |        7 |         4 |      10 |   36 |   61 |    1 |        3
  19 |        8 |         4 |      10 |   13 |   17 |    0 |        4
  20 |        9 |         4 |      10 | 4000 |   15 |    1 |        4
  21 |       10 |         4 |      10 |   10 |   -1 |    0 |        5
(10 rows)

SELECT * FROM q_result_1 WHERE start_vid = 4 AND end_vid = 10 AND (cost != 0 OR edge = -1);
 seq | path_seq | start_vid | end_vid | node | edge | cost | agg_cost 
-----+----------+-----------+---------+------+------+------+----------
  12 |        1 |         4 |      10 |    4 |    4 |    1 |        0
  14 |        3 |         4 |      10 |   16 |   21 |    1 |        1
  16 |        5 |         4 |      10 |   23 |   40 |    1 |        2
  18 |        7 |         4 |      10 |   36 |   61 |    1 |        3
  20 |        9 |         4 |      10 | 4000 |   15 |    1 |        4
  21 |       10 |         4 |      10 |   10 |   -1 |    0 |        5
(6 rows)

SELECT seq, path_seq, 
    (SELECT original_id FROM result2_vertices_pgr WHERE start_vid = id) AS start_vid, 
    (SELECT original_id FROM result2_vertices_pgr WHERE end_vid = id) AS end_vid,
    (SELECT original_id FROM result2_vertices_pgr WHERE node = id) AS node,
    coalesce((SELECT r.edge FROM result2 AS r WHERE q.edge = r.seq), -1) AS edge, cost, agg_cost
FROM q_result_1 AS q;
 seq | path_seq | start_vid | end_vid | node | edge  | cost | agg_cost 
-----+----------+-----------+---------+------+-------+------+----------
   1 |        1 |      2000 |    3000 | 2000 |   400 |    1 |        0
   2 |        2 |      2000 |    3000 | 5000 |     0 |    0 |        1
   3 |        3 |      2000 |    3000 | 5000 |   800 |    1 |        1
   4 |        4 |      2000 |    3000 | 6000 |     0 |    0 |        2
   5 |        5 |      2000 |    3000 | 6000 |   900 |    1 |        2
   6 |        6 |      2000 |    3000 | 9000 |     0 |    0 |        3
   7 |        7 |      2000 |    3000 | 9000 | -1600 |    1 |        3
   8 |        8 |      2000 |    3000 | 4000 |     0 |    0 |        4
   9 |        9 |      2000 |    3000 | 4000 |  -300 |    1 |        4
  10 |       10 |      2000 |    3000 | 3000 |     0 |    0 |        5
  11 |       11 |      2000 |    3000 | 3000 |    -1 |    0 |        5
  12 |        1 |      2000 |    3000 | 2000 |   400 |    1 |        0
  13 |        2 |      2000 |    3000 | 5000 |     0 |    0 |        1
  14 |        3 |      2000 |    3000 | 5000 |   800 |    1 |        1
  15 |        4 |      2000 |    3000 | 6000 |     0 |    0 |        2
  16 |        5 |      2000 |    3000 | 6000 |   900 |    1 |        2
  17 |        6 |      2000 |    3000 | 9000 |     0 |    0 |        3
  18 |        7 |      2000 |    3000 | 9000 | -1600 |    1 |        3
  19 |        8 |      2000 |    3000 | 4000 |     0 |    0 |        4
  20 |        9 |      2000 |    3000 | 4000 |  -300 |    1 |        4
  21 |       10 |      2000 |    3000 | 3000 |    -1 |    0 |        5
  22 |        1 |      2000 |    3000 | 2000 |   400 |    1 |        0
  23 |        2 |      2000 |    3000 | 5000 |     0 |    0 |        1
  24 |        3 |      2000 |    3000 | 5000 |   800 |    1 |        1
  25 |        4 |      2000 |    3000 | 6000 |     0 |    0 |        2
  26 |        5 |      2000 |    3000 | 6000 |   900 |    1 |        2
  27 |        6 |      2000 |    3000 | 9000 |     0 |    0 |        3
  28 |        7 |      2000 |    3000 | 9000 | -1600 |    1 |        3
  29 |        8 |      2000 |    3000 | 4000 |     0 |    0 |        4
  30 |        9 |      2000 |    3000 | 4000 |  -300 |    1 |        4
  31 |       10 |      2000 |    3000 | 3000 |     0 |    0 |        5
  32 |       11 |      2000 |    3000 | 3000 |    -1 |    0 |        5
  33 |        1 |      2000 |    3000 | 2000 |     0 |    0 |        0
  34 |        2 |      2000 |    3000 | 2000 |   400 |    1 |        0
  35 |        3 |      2000 |    3000 | 5000 |     0 |    0 |        1
  36 |        4 |      2000 |    3000 | 5000 |   800 |    1 |        1
  37 |        5 |      2000 |    3000 | 6000 |     0 |    0 |        2
  38 |        6 |      2000 |    3000 | 6000 |   900 |    1 |        2
  39 |        7 |      2000 |    3000 | 9000 |     0 |    0 |        3
  40 |        8 |      2000 |    3000 | 9000 | -1600 |    1 |        3
  41 |        9 |      2000 |    3000 | 4000 |     0 |    0 |        4
  42 |       10 |      2000 |    3000 | 4000 |  -300 |    1 |        4
  43 |       11 |      2000 |    3000 | 3000 |     0 |    0 |        5
  44 |       12 |      2000 |    3000 | 3000 |    -1 |    0 |        5
  45 |        1 |      2000 |    3000 | 2000 |     0 |    0 |        0
  46 |        2 |      2000 |    3000 | 2000 |   400 |    1 |        0
  47 |        3 |      2000 |    3000 | 5000 |     0 |    0 |        1
  48 |        4 |      2000 |    3000 | 5000 |   800 |    1 |        1
  49 |        5 |      2000 |    3000 | 6000 |     0 |    0 |        2
  50 |        6 |      2000 |    3000 | 6000 |   900 |    1 |        2
  51 |        7 |      2000 |    3000 | 9000 |     0 |    0 |        3
  52 |        8 |      2000 |    3000 | 9000 | -1600 |    1 |        3
  53 |        9 |      2000 |    3000 | 4000 |     0 |    0 |        4
  54 |       10 |      2000 |    3000 | 4000 |  -300 |    1 |        4
  55 |       11 |      2000 |    3000 | 3000 |    -1 |    0 |        5
  56 |        1 |      2000 |    3000 | 2000 |     0 |    0 |        0
  57 |        2 |      2000 |    3000 | 2000 |   400 |    1 |        0
  58 |        3 |      2000 |    3000 | 5000 |     0 |    0 |        1
  59 |        4 |      2000 |    3000 | 5000 |   800 |    1 |        1
  60 |        5 |      2000 |    3000 | 6000 |     0 |    0 |        2
  61 |        6 |      2000 |    3000 | 6000 |   900 |    1 |        2
  62 |        7 |      2000 |    3000 | 9000 |     0 |    0 |        3
  63 |        8 |      2000 |    3000 | 9000 | -1600 |    1 |        3
  64 |        9 |      2000 |    3000 | 4000 |     0 |    0 |        4
  65 |       10 |      2000 |    3000 | 4000 |  -300 |    1 |        4
  66 |       11 |      2000 |    3000 | 3000 |     0 |    0 |        5
  67 |       12 |      2000 |    3000 | 3000 |    -1 |    0 |        5
  68 |        1 |      2000 |    3000 | 2000 |     0 |    0 |        0
  69 |        2 |      2000 |    3000 | 2000 |   400 |    1 |        0
  70 |        3 |      2000 |    3000 | 5000 |     0 |    0 |        1
  71 |        4 |      2000 |    3000 | 5000 |   800 |    1 |        1
  72 |        5 |      2000 |    3000 | 6000 |     0 |    0 |        2
  73 |        6 |      2000 |    3000 | 6000 |   900 |    1 |        2
  74 |        7 |      2000 |    3000 | 9000 |     0 |    0 |        3
  75 |        8 |      2000 |    3000 | 9000 | -1600 |    1 |        3
  76 |        9 |      2000 |    3000 | 4000 |     0 |    0 |        4
  77 |       10 |      2000 |    3000 | 4000 |  -300 |    1 |        4
  78 |       11 |      2000 |    3000 | 3000 |     0 |    0 |        5
  79 |       12 |      2000 |    3000 | 3000 |    -1 |    0 |        5
  80 |        1 |      2000 |    3000 | 2000 |     0 |    0 |        0
  81 |        2 |      2000 |    3000 | 2000 |   400 |    1 |        0
  82 |        3 |      2000 |    3000 | 5000 |     0 |    0 |        1
  83 |        4 |      2000 |    3000 | 5000 |   800 |    1 |        1
  84 |        5 |      2000 |    3000 | 6000 |     0 |    0 |        2
  85 |        6 |      2000 |    3000 | 6000 |   900 |    1 |        2
  86 |        7 |      2000 |    3000 | 9000 |     0 |    0 |        3
  87 |        8 |      2000 |    3000 | 9000 | -1600 |    1 |        3
  88 |        9 |      2000 |    3000 | 4000 |     0 |    0 |        4
  89 |       10 |      2000 |    3000 | 4000 |  -300 |    1 |        4
  90 |       11 |      2000 |    3000 | 3000 |    -1 |    0 |        5
  91 |        1 |      2000 |    3000 | 2000 |     0 |    0 |        0
  92 |        2 |      2000 |    3000 | 2000 |   400 |    1 |        0
  93 |        3 |      2000 |    3000 | 5000 |     0 |    0 |        1
  94 |        4 |      2000 |    3000 | 5000 |   800 |    1 |        1
  95 |        5 |      2000 |    3000 | 6000 |     0 |    0 |        2
  96 |        6 |      2000 |    3000 | 6000 |   900 |    1 |        2
  97 |        7 |      2000 |    3000 | 9000 |     0 |    0 |        3
  98 |        8 |      2000 |    3000 | 9000 | -1600 |    1 |        3
  99 |        9 |      2000 |    3000 | 4000 |     0 |    0 |        4
 100 |       10 |      2000 |    3000 | 4000 |  -300 |    1 |        4
 101 |       11 |      2000 |    3000 | 3000 |     0 |    0 |        5
 102 |       12 |      2000 |    3000 | 3000 |    -1 |    0 |        5
 103 |        1 |      2000 |    3000 | 2000 |     0 |    0 |        0
 104 |        2 |      2000 |    3000 | 2000 |   400 |    1 |        0
 105 |        3 |      2000 |    3000 | 5000 |     0 |    0 |        1
 106 |        4 |      2000 |    3000 | 5000 |   800 |    1 |        1
 107 |        5 |      2000 |    3000 | 6000 |     0 |    0 |        2
 108 |        6 |      2000 |    3000 | 6000 |   900 |    1 |        2
 109 |        7 |      2000 |    3000 | 9000 |     0 |    0 |        3
 110 |        8 |      2000 |    3000 | 9000 | -1600 |    1 |        3
 111 |        9 |      2000 |    3000 | 4000 |     0 |    0 |        4
 112 |       10 |      2000 |    3000 | 4000 |  -300 |    1 |        4
 113 |       11 |      2000 |    3000 | 3000 |     0 |    0 |        5
 114 |       12 |      2000 |    3000 | 3000 |    -1 |    0 |        5
 115 |        1 |      2000 |    3000 | 2000 |     0 |    0 |        0
 116 |        2 |      2000 |    3000 | 2000 |   400 |    1 |        0
 117 |        3 |      2000 |    3000 | 5000 |     0 |    0 |        1
 118 |        4 |      2000 |    3000 | 5000 |   800 |    1 |        1
 119 |        5 |      2000 |    3000 | 6000 |     0 |    0 |        2
 120 |        6 |      2000 |    3000 | 6000 |   900 |    1 |        2
 121 |        7 |      2000 |    3000 | 9000 |     0 |    0 |        3
 122 |        8 |      2000 |    3000 | 9000 | -1600 |    1 |        3
 123 |        9 |      2000 |    3000 | 4000 |     0 |    0 |        4
 124 |       10 |      2000 |    3000 | 4000 |  -300 |    1 |        4
 125 |       11 |      2000 |    3000 | 3000 |    -1 |    0 |        5
 126 |        1 |      2000 |    3000 | 2000 |     0 |    0 |        0
 127 |        2 |      2000 |    3000 | 2000 |   400 |    1 |        0
 128 |        3 |      2000 |    3000 | 5000 |     0 |    0 |        1
 129 |        4 |      2000 |    3000 | 5000 |   800 |    1 |        1
 130 |        5 |      2000 |    3000 | 6000 |     0 |    0 |        2
 131 |        6 |      2000 |    3000 | 6000 |   900 |    1 |        2
 132 |        7 |      2000 |    3000 | 9000 |     0 |    0 |        3
 133 |        8 |      2000 |    3000 | 9000 | -1600 |    1 |        3
 134 |        9 |      2000 |    3000 | 4000 |     0 |    0 |        4
 135 |       10 |      2000 |    3000 | 4000 |  -300 |    1 |        4
 136 |       11 |      2000 |    3000 | 3000 |     0 |    0 |        5
 137 |       12 |      2000 |    3000 | 3000 |    -1 |    0 |        5
 138 |        1 |      2000 |    3000 | 2000 |  -100 |    1 |        0
 139 |        2 |      2000 |    3000 | 1000 |     0 |    0 |        1
 140 |        3 |      2000 |    3000 | 1000 |   100 |    1 |        1
 141 |        4 |      2000 |    3000 | 2000 |     0 |    0 |        2
 142 |        5 |      2000 |    3000 | 2000 |   400 |    1 |        2
 143 |        6 |      2000 |    3000 | 5000 |     0 |    0 |        3
 144 |        7 |      2000 |    3000 | 5000 |   800 |    1 |        3
 145 |        8 |      2000 |    3000 | 6000 |     0 |    0 |        4
 146 |        9 |      2000 |    3000 | 6000 |   900 |    1 |        4
 147 |       10 |      2000 |    3000 | 9000 |     0 |    0 |        5
 148 |       11 |      2000 |    3000 | 9000 | -1600 |    1 |        5
 149 |       12 |      2000 |    3000 | 4000 |     0 |    0 |        6
 150 |       13 |      2000 |    3000 | 4000 |  -300 |    1 |        6
 151 |       14 |      2000 |    3000 | 3000 |     0 |    0 |        7
 152 |       15 |      2000 |    3000 | 3000 |    -1 |    0 |        7
 153 |        1 |      2000 |    3000 | 2000 |  -100 |    1 |        0
 154 |        2 |      2000 |    3000 | 1000 |     0 |    0 |        1
 155 |        3 |      2000 |    3000 | 1000 |   100 |    1 |        1
 156 |        4 |      2000 |    3000 | 2000 |     0 |    0 |        2
 157 |        5 |      2000 |    3000 | 2000 |   400 |    1 |        2
 158 |        6 |      2000 |    3000 | 5000 |     0 |    0 |        3
 159 |        7 |      2000 |    3000 | 5000 |   800 |    1 |        3
 160 |        8 |      2000 |    3000 | 6000 |     0 |    0 |        4
 161 |        9 |      2000 |    3000 | 6000 |   900 |    1 |        4
 162 |       10 |      2000 |    3000 | 9000 |     0 |    0 |        5
 163 |       11 |      2000 |    3000 | 9000 | -1600 |    1 |        5
 164 |       12 |      2000 |    3000 | 4000 |     0 |    0 |        6
 165 |       13 |      2000 |    3000 | 4000 |  -300 |    1 |        6
 166 |       14 |      2000 |    3000 | 3000 |    -1 |    0 |        7
 167 |        1 |      2000 |    3000 | 2000 |  -100 |    1 |        0
 168 |        2 |      2000 |    3000 | 1000 |     0 |    0 |        1
 169 |        3 |      2000 |    3000 | 1000 |   100 |    1 |        1
 170 |        4 |      2000 |    3000 | 2000 |     0 |    0 |        2
 171 |        5 |      2000 |    3000 | 2000 |   400 |    1 |        2
 172 |        6 |      2000 |    3000 | 5000 |     0 |    0 |        3
 173 |        7 |      2000 |    3000 | 5000 |   800 |    1 |        3
 174 |        8 |      2000 |    3000 | 6000 |     0 |    0 |        4
 175 |        9 |      2000 |    3000 | 6000 |   900 |    1 |        4
 176 |       10 |      2000 |    3000 | 9000 |     0 |    0 |        5
 177 |       11 |      2000 |    3000 | 9000 | -1600 |    1 |        5
 178 |       12 |      2000 |    3000 | 4000 |     0 |    0 |        6
 179 |       13 |      2000 |    3000 | 4000 |  -300 |    1 |        6
 180 |       14 |      2000 |    3000 | 3000 |     0 |    0 |        7
 181 |       15 |      2000 |    3000 | 3000 |    -1 |    0 |        7
(181 rows)

SELECT seq, path_seq, 
    (SELECT original_id FROM result2_vertices_pgr WHERE start_vid = id) AS start_vid, 
    (SELECT original_id FROM result2_vertices_pgr WHERE end_vid = id) AS end_vid,
    (SELECT original_id FROM result2_vertices_pgr WHERE node = id) AS node,
    coalesce((SELECT abs(r.edge) FROM result2 AS r WHERE q.edge = r.seq), -1) AS edge, cost, agg_cost
FROM q_result_1 AS q
WHERE start_vid = 4 AND end_vid = 10;
 seq | path_seq | start_vid | end_vid | node | edge | cost | agg_cost 
-----+----------+-----------+---------+------+------+------+----------
  12 |        1 |      2000 |    3000 | 2000 |  400 |    1 |        0
  13 |        2 |      2000 |    3000 | 5000 |    0 |    0 |        1
  14 |        3 |      2000 |    3000 | 5000 |  800 |    1 |        1
  15 |        4 |      2000 |    3000 | 6000 |    0 |    0 |        2
  16 |        5 |      2000 |    3000 | 6000 |  900 |    1 |        2
  17 |        6 |      2000 |    3000 | 9000 |    0 |    0 |        3
  18 |        7 |      2000 |    3000 | 9000 | 1600 |    1 |        3
  19 |        8 |      2000 |    3000 | 4000 |    0 |    0 |        4
  20 |        9 |      2000 |    3000 | 4000 |  300 |    1 |        4
  21 |       10 |      2000 |    3000 | 3000 |   -1 |    0 |        5
(10 rows)

SELECT seq, path_seq, 
    (SELECT original_id FROM result2_vertices_pgr WHERE start_vid = id) AS start_vid, 
    (SELECT original_id FROM result2_vertices_pgr WHERE end_vid = id) AS end_vid,
    (SELECT original_id FROM result2_vertices_pgr WHERE node = id) AS node,
    coalesce((SELECT abs(r.edge) FROM result2 AS r WHERE q.edge = r.seq), -1) AS edge, cost, agg_cost
FROM q_result_1 AS q
WHERE start_vid = 4 AND end_vid = 10 AND (
    cost != 0 OR edge = -1 OR path_seq = 1);
 seq | path_seq | start_vid | end_vid | node | edge | cost | agg_cost 
-----+----------+-----------+---------+------+------+------+----------
  12 |        1 |      2000 |    3000 | 2000 |  400 |    1 |        0
  14 |        3 |      2000 |    3000 | 5000 |  800 |    1 |        1
  16 |        5 |      2000 |    3000 | 6000 |  900 |    1 |        2
  18 |        7 |      2000 |    3000 | 9000 | 1600 |    1 |        3
  20 |        9 |      2000 |    3000 | 4000 |  300 |    1 |        4
  21 |       10 |      2000 |    3000 | 3000 |   -1 |    0 |        5
(6 rows)

SELECT * from pgr_dijkstra($$SELECT id, * FROM edge_table$$,
    ARRAY[2000]::BIGINT[], ARRAY[3000]::BIGINT[]);
 seq | path_seq | start_vid | end_vid | node | edge | cost | agg_cost 
-----+----------+-----------+---------+------+------+------+----------
   1 |        1 |      2000 |    3000 | 2000 |  400 |    1 |        0
   2 |        2 |      2000 |    3000 | 5000 |  800 |    1 |        1
   3 |        3 |      2000 |    3000 | 6000 |  900 |    1 |        2
   4 |        4 |      2000 |    3000 | 9000 | 1600 |    1 |        3
   5 |        5 |      2000 |    3000 | 4000 |  300 |    1 |        4
   6 |        6 |      2000 |    3000 | 3000 |   -1 |    0 |        5
(6 rows)

SELECT seq, path_seq, 
    (SELECT original_id FROM result2_vertices_pgr WHERE node = id) AS node,
    coalesce((SELECT abs(r.edge) FROM result2 AS r WHERE q.edge = r.seq), -1) AS edge, cost, agg_cost
FROM q_result_1 AS q
WHERE start_vid = 4 AND end_vid = 10 AND (
    cost != 0 OR edge = -1 OR path_seq = 1);
 seq | path_seq | node | edge | cost | agg_cost 
-----+----------+------+------+------+----------
  12 |        1 | 2000 |  400 |    1 |        0
  14 |        3 | 5000 |  800 |    1 |        1
  16 |        5 | 6000 |  900 |    1 |        2
  18 |        7 | 9000 | 1600 |    1 |        3
  20 |        9 | 4000 |  300 |    1 |        4
  21 |       10 | 3000 |   -1 |    0 |        5
(6 rows)

SELECT * from pgr_dijkstra($$SELECT id, * FROM edge_table$$,
    2000, 3000);
 seq | path_seq | node | edge | cost | agg_cost 
-----+----------+------+------+------+----------
   1 |        1 | 2000 |  400 |    1 |        0
   2 |        2 | 5000 |  800 |    1 |        1
   3 |        3 | 6000 |  900 |    1 |        2
   4 |        4 | 9000 | 1600 |    1 |        3
   5 |        5 | 4000 |  300 |    1 |        4
   6 |        6 | 3000 |   -1 |    0 |        5
(6 rows)

ROLLBACK;
ROLLBACK
