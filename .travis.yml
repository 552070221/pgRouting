# ------------------------------------------------------------------------------
# Travis CI scripts 
# Copyright(c) pgRouting Contributors
#
# Main configuration
# ------------------------------------------------------------------------------

language: cpp

sudo: required

compiler:
  - gcc-4.8

notifications:
  email:
    on_failure: vicky@georepublic.com

branches:
  only:
    - new-travis-dev

addons:
  postgresql: "9.4"

  # Dependencies on linux.
  apt:
    sources:
      # For gcc >= 4.8
      - ubuntu-toolchain-r-test
      # For cmake >= 2.8.8 (for CMakePackageConfigHelpers)
      - kubuntu-backports
      - boost-latest
    packages:
      - cmake
      - gcc-4.8
      - g++-4.8
#      - libboost-dev
#      - libboost-thread-dev
#      - libboost-program-options-dev
      - libboost1.55-dev
      - libboost-thread1.55-dev
      - libboost-program-options1.55-dev
#      - libboost-system-dev
      - libboost-graph1.55-dev
#      - libcgal-dev
      - postgresql-server-dev-9.4

#  postgresql: "9.3"
#  postgresql: "9.4"

#services:
  #- postgresql: 9.1
  #- postgresql: 9.2
  #- postgresql: 9.3

#matrix:
#  env: BUILD_TOOL=cmake
#  include:
#    - os: linux
#      compiler: gcc-4.8


env:
  matrix:
    - POSTGRESQL_VERSION=9.4 POSTGIS_VERSION=2.1
#    - POSTGRESQL_VERSION=9.3 POSTGIS_VERSION=2.1
#    - POSTGRESQL_VERSION=9.2 POSTGIS_VERSION=2.1
#    - POSTGRESQL_VERSION=9.1 POSTGIS_VERSION=2.1

#    - POSTGRESQL_VERSION=9.4 POSTGIS_VERSION=2.0
#    - POSTGRESQL_VERSION=9.3 POSTGIS_VERSION=2.0
#    - POSTGRESQL_VERSION=9.2 POSTGIS_VERSION=2.0
#    - POSTGRESQL_VERSION=9.1 POSTGIS_VERSION=2.0

    ## We are NOT supporting these for pgrouting 2.1.0
    #- POSTGRESQL_VERSION=8.4 POSTGIS_VERSION=1.5
    #- POSTGRESQL_VERSION=9.0 POSTGIS_VERSION=1.5
    #- POSTGRESQL_VERSION=9.1 POSTGIS_VERSION=1.5



before_install:
  - cmake --version
  - gcc-4.8 --version
  - sudo apt-get build-dep -y install libcgal-dev libboost-dev libboost-thread-dev libboost-program-options-dev
#  - wget https://github.com/CGAL/cgal/releases/download/releases%2FCGAL-4.7/CGAL-4.7.tar.gz
#  - tar -xvf CGAL-4.7.tar.gz
#  - cd CGAL-4.7 && cmake . && make && sudo make install 

install:
#  - ./tools/travis/pgrouting_install.sh $POSTGRESQL_VERSION $POSTGIS_VERSION

before_script:
#  -

script: 
  - ./tools/travis/pgrouting_build.sh $POSTGRESQL_VERSION $POSTGIS_VERSION

after_script: 
#  - ./tools/travis/pgrouting_prepare.sh $POSTGRESQL_VERSION $POSTGIS_VERSION
#  - ./tools/travis/pgrouting_test.sh $POSTGRESQL_VERSION $POSTGIS_VERSION

after_success:
  #- ./tools/travis/pgrouting_deploy.sh $POSTGRESQL_VERSION $POSTGIS_VERSION

